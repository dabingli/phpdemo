<?php
header("Content-type:text/html;charset=gbk-2312");
$privkeypass = '1234qwer'; //私钥密码
$str = '308204F2308203DAA00302010202054112164331300D06092A864886F70D01010B05003058310B300906035504061302434E3130302E060355040A0C274368696E612046696E616E6369616C2043657274696669636174696F6E20417574686F726974793117301506035504030C0E4346434120414353204F43413331301E170D3138303532333038333735305A170D3231303532333038333735305A3081A0310B300906035504061302434E31173015060355040A0C0E4346434120414353204F4341333131133011060355040B0C0A43464341204F4341333131193017060355040B0C104F7267616E697A6174696F6E616C2D313148304606035504030C3F4346434140E4B88AE6B5B7E794B5E993B6E4BFA1E681AFE68A80E69CAFE69C89E99990E585ACE58FB8404E393133313030303035373037363637363130403230820122300D06092A864886F70D01010105000382010F003082010A0282010100A1BCF69716CC5820D691D49E8DE63D2DA2154F11BFE21C8A48571D93D361A4171655145D52686004A2F4740ED408D095CB0DAFF53E23671BDFF8F84B528FEC6DC160B3754808E0543541037A9B5CE2F182ED6C1E5F29DE3C891B22EFA24B52BF27F758F7693DBE37A66F66D453F1622B9B9B38C48487F8522AC05D9580A08747786CA0F5398FFA814B35954004C250EFCD626B52480BA5CB0F0917E6ABDACCBE2DEE117C9345FAD2D5ED283DB8C0B5B0A66BD19E1553D9B1A2AFB3D8A9026856AF84E011A67C8FD1645107E5D3E0DBFB876B347FF25A6EB79B65901C20EBF82171CBE5F8478A86D509F5D091CA0947D4EEAC5B05DF575F27E45601439ED389470203010001A382017830820174306C06082B060105050701010460305E302806082B06010505073001861C687474703A2F2F6F6373702E636663612E636F6D2E636E2F6F637370303206082B060105050730028626687474703A2F2F63726C2E636663612E636F6D2E636E2F6F636133312F6F636133312E636572301F0603551D23041830168014E2B409CBCD61A1734A797FF18A830BDDB47E8C1D300C0603551D130101FF0402300030480603551D200441303F303D060860811C86EF2A01043031302F06082B060105050702011623687474703A2F2F7777772E636663612E636F6D2E636E2F75732F75732D31342E68746D303D0603551D1F043630343032A030A02E862C687474703A2F2F63726C2E636663612E636F6D2E636E2F6F636133312F5253412F63726C313133362E63726C300E0603551D0F0101FF0404030206C0301D0603551D0E04160414043385BE434CCF92D41704B67C2E0A1733F70134301D0603551D250416301406082B0601050507030206082B06010505070304300D06092A864886F70D01010B05000382010100AD1D218D9E30F64E6136EF90D09C391EDFD695EA3CFE3D9245DB07F19C7220ADF7A940EAA482FE1335910AE04C63487D5F82E10AEB1A459FA55462B288B0D1346CB40D29CACADBA9CB1C486255104A5B77A8F90F7B6F9E1D612AA52838D57443DE06354494ACF702C198C4FDEB51C8CEF9ED398CC42E2E4B6D5B6B92D605E2FF1EB8F89B4E884CA28A69CBAEE77EC002024D0E61EEA8550F41EDDBE2F3B6AECF12419364ECCA59A39B45DFE96E1C3C81A42F36597880512B18AD02C436F32729A9CD405E2773E7616032FADD4A89BEB3C2151312B08A0C110EA5B7F80FE01E0D33EEF511EDB4D8685C0568D0462F747D1B95E5B367E3A1DC4094500C1620D59F';

$public = 'MIIE8jCCA9qgAwIBAgIFQRIWQzEwDQYJKoZIhvcNAQELBQAwWDELMAkGA1UEBhMCQ04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEXMBUGA1UEAwwOQ0ZDQSBBQ1MgT0NBMzEwHhcNMTgwNTIzMDgzNzUwWhcNMjEwNTIzMDgzNzUwWjCBoDELMAkGA1UEBhMCQ04xFzAVBgNVBAoMDkNGQ0EgQUNTIE9DQTMxMRMwEQYDVQQLDApDRkNBIE9DQTMxMRkwFwYDVQQLDBBPcmdhbml6YXRpb25hbC0xMUgwRgYDVQQDDD9DRkNBQOS4iua1t+eUtemTtuS/oeaBr+aKgOacr+aciemZkOWFrOWPuEBOOTEzMTAwMDA1NzA3NjY3NjEwQDIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQChvPaXFsxYINaR1J6N5j0tohVPEb/iHIpIVx2T02GkFxZVFF1SaGAEovR0DtQI0JXLDa/1PiNnG9/4+EtSj+xtwWCzdUgI4FQ1QQN6m1zi8YLtbB5fKd48iRsi76JLUr8n91j3aT2+N6ZvZtRT8WIrm5s4xISH+FIqwF2VgKCHR3hsoPU5j/qBSzWVQATCUO/NYmtSSAulyw8JF+ar2sy+Le4RfJNF+tLV7Sg9uMC1sKZr0Z4VU9mxoq+z2KkCaFavhOARpnyP0WRRB+XT4Nv7h2s0f/JabrebZZAcIOv4IXHL5fhHiobVCfXQkcoJR9TurFsF31dfJ+RWAUOe04lHAgMBAAGjggF4MIIBdDBsBggrBgEFBQcBAQRgMF4wKAYIKwYBBQUHMAGGHGh0dHA6Ly9vY3NwLmNmY2EuY29tLmNuL29jc3AwMgYIKwYBBQUHMAKGJmh0dHA6Ly9jcmwuY2ZjYS5jb20uY24vb2NhMzEvb2NhMzEuY2VyMB8GA1UdIwQYMBaAFOK0CcvNYaFzSnl/8YqDC920fowdMAwGA1UdEwEB/wQCMAAwSAYDVR0gBEEwPzA9BghggRyG7yoBBDAxMC8GCCsGAQUFBwIBFiNodHRwOi8vd3d3LmNmY2EuY29tLmNuL3VzL3VzLTE0Lmh0bTA9BgNVHR8ENjA0MDKgMKAuhixodHRwOi8vY3JsLmNmY2EuY29tLmNuL29jYTMxL1JTQS9jcmwxMTM2LmNybDAOBgNVHQ8BAf8EBAMCBsAwHQYDVR0OBBYEFAQzhb5DTM+S1BcEtnwuChcz9wE0MB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDBDANBgkqhkiG9w0BAQsFAAOCAQEArR0hjZ4w9k5hNu+Q0Jw5Ht/Wleo8/j2SRdsH8ZxyIK33qUDqpIL+EzWRCuBMY0h9X4LhCusaRZ+lVGKyiLDRNGy0DSnKytupyxxIYlUQSlt3qPkPe2+eHWEqpSg41XRD3gY1RJSs9wLBmMT961HIzvntOYzELi5LbVtrktYF4v8euPibTohMooppy67nfsACAk0OYe6oVQ9B7dvi87auzxJBk2Tsylmjm0Xf6W4cPIGkLzZZeIBRKxitAsQ28ycpqc1AXidz52FgMvrdSom+s8IVExKwigwRDqW3+A/gHg0z7vUR7bTYaFwFaNBGL3R9G5Xls2fjodxAlFAMFiDVnw==';

$pfxpath = "./merchant.pfx"; //密钥文件路径
// $pfxpath = "./shdy_prod.cer"; //密钥文件路径
$priv_key = file_get_contents($pfxpath); //获取密钥文件内容
// $priv_key = json_encode($priv_key);
// 私钥加密
openssl_pkcs12_read($priv_key, $certs, $privkeypass); //读取公钥、私钥

$res = $certs['cert'];
$priv_key = str_replace(['-----BEGIN CERTIFICATE-----','-----END CERTIFICATE-----'],"",$certs['cert']);
$priv_key = base64_decode($priv_key,1);
$sign = strtoupper(bin2hex($priv_key));
var_dump($sign,$str);die;

var_dump(hex2bin($str));